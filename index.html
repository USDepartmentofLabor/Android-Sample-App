<!DOCTYPE HTML>
<HTML> 
<HEAD> 
<TITLE>U.S. Department of Labor -- The Department of Labor Developer Community</TITLE>
<META NAME="keywords" CONTENT="Department of Labor, DOL, Secretary of Labor" />
<!-- begin dol-styles.shtm -->
<link rel="shortcut icon" href="http://www.dol.gov/favicon.ico" type="image/x-icon">
<link rel="icon" href="http://www.dol.gov/favicon.ico" type="image/x-icon">
<link href="http://www.dol.gov/dol.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="http://developer.dol.gov/api.css" TYPE="text/css" />
<link href="http://webapps.dol.gov/FSPublic/Content/W_Helpful.css" rel="stylesheet" type="text/css">
<style type="text/css">
<!--
caption {text-align:left; font-size:80%}
table{margin-left:12px;}


-->
</style>

<!-- end dol-styles.shtm -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
<script type="text/javascript" src="prettify.js"></script>
<script language="JavaScript" type="text/javascript">

	jQuery(document).ready(function(){

		// This line of code makes code pretty to look at and understand.
		window.prettyPrint && prettyPrint()
	
	});
	


</script>
<!--start include header-dest-redesign3.shtm -->
<script src="http://webapps.dol.gov/FSPublic/Scripts/W_Helpful.js" type="text/javascript"></script>
<script type="text/javascript">
		$(document).ready(function() {
			W_Helpful.init('#fbcontent');
		});
</script> 
</HEAD> 
<BODY> 
<a href="https://github.com/USDepartmentofLabor/Android-Sample-App"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
<div id="Main">
	<!--Header Start -->
    <a href="#pagecontent" class="skipster">Skip to page content</a>

<div id="Header">
    <div id="Banner">
        <p class="banner"><a href="http://www.dol.gov">United States Department of Labor</a></p>
    </div>
		<div id="RightColumn"><table><tr><td valign="bottom">
		
			</td><td>
            
  
 
 
 
            
            
          </td></tr>
		  <tr><td colspan="2">
			<!--<div id="Nav" class="navlinks">
				<a href="http://www.dol.gov/dol/siteindex.htm">A to Z</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/findit.htm">Site Map</a>&nbsp;|&nbsp;
				<a href="http://webapps.dol.gov/dolfaq/dolfaq.asp">FAQs</a>&nbsp;|&nbsp;

				<a href="http://webapps.dol.gov/libraryforms">Forms</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/aboutdol/main.htm">About DOL</a>&nbsp;|&nbsp; 
				<a href="http://www.dol.gov/dol/contact">Contact Us</a>&nbsp;|&nbsp;
                		<a href="http://www.dol.gov/dol/topic/Spanish-speakingTopic.htm">Espa&#241;ol</a>
			</div>

			--></td></tr></table>
		</div>
	</div>
    
	<!--Header End -->

	<!--Body Start -->
	<div id="Body">
		<div id="UtilityBar" class="tools">
			<div class="utilitybarleft"><div id="agencyname">&nbsp;</div></div>

			<!-- This is where the E-mail This page use to be -->
			<div class="utilitybarright">
				<div id="fbcontent" style="float:right"></div>			
			</div>
		</div>
		<div class="crumb-links"><!-- begin crumb-nonav-auto.shtm -->
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
  <TR>
    <TD VALIGN="middle" ALIGN="LEFT" height="7" style="padding-left:2px"><span class="crumb-links">
      <a href="http://www.dol.gov">DOL Home</a> &gt; <a href="http://www.dol.gov/open/">OPEN</a> &gt; <a href="http://developer.dol.gov">Developer Community</a> &gt; Android DOL Data SDK Sample
      </span> </td>

  </tr>
</table>
<!-- end crumb-nonav-auto.shtm --></div>
		<div id="content" >
			<div id="pagecontent" style="width:768px;font-size:0;line-height:0;"></div>

<!--end include header-dest-redesign3.shtm -->
<!-- START CONTENT HERE  *************************************************** -->
<h1>Android Government Data SDK Sample</h1>

<h2>Overview</h2>
<p>
This sample will provide the steps to create a simple Android application that can consume Goverment Entity Web Service  Data. 
Following these steps in order will allow your application to operate correctly.  
<a href="https://github.com/USDepartmentofLabor/Android-Sample-App">Download this project</a>
</p>
<p>This solution was built using:</p>
<ul>
<li>Eclipse JEE Helio SR2 windows 32</li>
<li>
<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK</a>
</li>
<li>
<a href="http://developer.android.com/sdk/index.html">Android SDK</a>
</li>
<li>ADT plug-in. You can install it using the Eclipse IDE(Help Menu=> Install New Software). </li>
</ul>
<br>
<h2>Download Android SDK</h2>
<p>
Installation instructions are provided in detail <a href="https://github.com/USDepartmentofLabor/Android_DOLDataSDK">here</a> to setup an android development environment.  
After installation it is important to follow the steps for installing ADT plug-in and additional components.<br>
<sup>*</sup>note: Save the SDK in a location where there are no spaces in the directory path.  The Android emulator may behave incorrectly if this path has spaces.
<br><br>
</p>
<br>

<h2>Create a New Project</h2>
<p>
For this sample we are going to create a new Android application that will consume and list Agency data.<br><br>
Start by creating a new workspace or selecting a workspace of your choice.  <br><br>

<img alt="Select Workspace and Select the installation location of your android SDK" src="images/Workspace.png"  /><br><br>

For new workspaces Click <strong>Window  >  Preferences</strong> a window will be displayed, at this time select <strong>Android</strong>.  Select the installation location of your android SDK.<br><br>

<img alt="Workspace Setup " src="images/WorkspaceSetup.png"  /><br><br>

Then open a new project by Clicking <strong>File  >  New Android Project</strong>.<br><br>

<img alt="open a new project by Clicking File > New Android Project." src="images/NewProject.png"  /><br><br>

You will need to provide information in order to proceed.
</p>
<ul>
<li>Choose a <strong>project name</strong>; this will be display as the root item in your project.</li>
<li>Choose a <strong>Build Target</strong>; this will determine what components will be available to your application.  It will also set a list of minimum requirements for the android device.</li>
<li>Choose an <strong>Application Name</strong>; this will be used through your application and resources.</li>
<li>Choose a <strong>Package name</strong>; this is where Eclipse will set you Java Package for this application.</li>
<li>Finally, choose the <strong>Activity name</strong>; this is the main entry form for the Android application.</li>
</ul>
<p>
For this project Android 2.2 platform has been used to cover a wider target.<br><br>
<img alt="Choose Project Name,BuildTarget,Applciation name and package Name" src="images/ProjectDetails2.png" WIDTH="60%" /><br><br>
</p>
<br>

<h2>Add the SDK To Your Project</h2>
<p>
All requests require account credentials to be submitted along with the request.  
This SDK contains a few classes needed to process service requests.  
This package needs to be imported into your project.  You can grab the <a href="https://github.com/USDepartmentofLabor/Android_DOLDataSDK">Git repository</a>.<br><br>

<img alt="Add SDK package to Project" src="images/AddSdk.png"  /><br><br>
Import the Android_DOLDataSDK into your project using the <strong>General > File System</strong> option.<br><br>

<img alt="Import SDK by selecting File system" src="images/AddSdk2.png"  /><br><br>

Choose the root path and click ok.<br><br>

<img alt="Choose root" src="images/AddSdk3.png"  /><br><br>
</p>
<br>

<h2>Locate the Dataset Path</h2>
<p>
Each Dataset has a Dataset Location path that gives the URL that will be needed to reach the Dataset on the API. For this sample, use 
	http://api.dol.gov/V1/DOLAgency<br><br>
<img alt="Locate Dataset Location path from Dataset" src="images/DatasetLocation.png" WIDTH="60%"  /><br><br>
</p>
<br>

<p>
    For the DOL Service Operation sample please use http://api.dol.gov/V1/SummerJobs<br><br>


<h2>Define the User Interface</h2>
<p>
Add a new Layout to your project by navigating to <strong>res > layout</strong> folder and click the right mouse button to get a menu.  Select <strong>New</strong> then select <strong>Android XML File</strong>.
In this window you choose the following options.<br>
</p>
<ul>
	<li>File name -  the name of the file, for this project, we will use list_item for the name.  This name will be reference later in the code and is case sensitive.</li>
	<li>Resource Type - We are going to create a new <strong>Layout</strong> to display our results.</li>
	<li>Root Element - We are going to choose a TextView to be our root element to display.</li>
</ul>
<br><br>

<p>
<img alt="Configure Xml to define the user interface" src="images/AddLayout.png" /><br><br>
Adding a few lines to this file in the XML view will allow us to customize its appearance.<br><br>
<pre class="prettyprint">&lt;?xml version=”1.0” encoding=”utf-8”?&gt;
&lt;TextView
	xmlns:android=”http://schemas.android.com/apk/res/android”
		android:layout_width=”fill_parent”
		android:layout_height=”fill_parent”
		android:padding=”10dp”
		android:textSize=”16sp” &gt;
&lt;/TextView&gt;</pre><br><br>
</p>
<br>

<h2>Implementing the Government Data Request</h2>
<p>
The DOLDataAPI.java file handles the behavior of the layout form that we created earlier.  
This file is found under <strong>src > gov.SDK.sample</strong>.
The SDK classes need to be accessible from here so we add them with java import statements.<br><br>

<pre class="prettyprint">import govdata.api.GOVDataContext;
import govdata.api.GOVDataRequest;
import govdata.api.GOVDataRequestCallback;</pre><br><br>

<p>Additionally, we are going to add a few more utility classes that will help us provide functionality not found in the SDK.</p>

<pre class="prettyprint">
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import android.app.AlertDialog;
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;</pre><br><br>


<p>
 For DOL Service Operation (e.g. Summer Job Plus)  please import additional json package to parse the json result text.<br><br>
<pre class="prettyprint">import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;</pre>
<br>


<p>We will modify the basic <strong>DOLDataAPI Activity</strong> and use a <strong>ListActivity</strong> instead to handle multiple items.
We also inherited functionality from the <strong>GOVDataRequestCallback</strong> interface to handle the results of the service call.
 </p>
<p>
Secure logins are provided using the following code; we will need to modify both the <strong>ApiKey</strong> and the <strong>SharedSecret</strong> variable of this method to access DOL Data.<br>
Add members to the  <strong>DOLDataAPI ListActivity class</strong> within the <strong>DOLDataAPI.java</strong> file.<br></p>
<ul>
<li>The <strong>ApiKey</strong> corresponds to the <strong>Token</strong> identifier in your token list.</li>
<li>The <strong>SharedSecret</strong> created during setup is the same value that is used in the DOLDataUtil class.</li>
</ul>
<p>
<pre class="prettyprint">public final String API_KEY = “”;
public final String SHARED_SECRET = “”;</pre><br><br>
</p>

 <pre class="prettyprint">public class DOLDataAPI extends ListActivity implements GOVDataRequestCallback  {
	/** Called when the activity is first created. */
 
// API Key and URL constants
	public final String API_KEY =  "";
	public final String SHARED_SECRET = "";
	public final String API_URI = "/v1";
	public final String API_HOST = "http://api.dol.gov";
	public final String API_DATA = "DolAgency/Agencies";

	@Override
	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
	}
 
	// Callback method called when error occurs
	public void GOVDataErrorCallback(String error) {
	}
 
	//Callback method called when results are returned and parsed
	public void GOVDataResultsCallback(List&lt;Map&lt;String, String&gt;&gt; results) {
	}
}</pre><br><br>
<h3><a name="Federal"></a>Using This SDK With APIs From Other Federal Agencies</h3>
<p>The example above uses DOL's API.  Some federal APIs' URLs are structured differently.  For example, let's look at http://business.usa.gov/api/article/xml
<ul>
	<li>API_LOGIN = ""</li>
    <li>API_KEY = ""</li>
	<li>SHARED_SECRET = ""</li>
	<li>API_HOST = "http://business.usa.gov"</li>
	<li>API_URI = "/api"</li>
	<li>API_DATA = "/article/xml"</li>
</ul></p>

<p>Let's look at the Census Bureau.  For example, http://api.census.gov/data/2010/acs5?key={your key}&get=B02001_001E,NAME&for=state:06,36
<ul>
    <li>API_LOGIN = ""</li>
	<li>API_KEY = "key={your key}"</li>
	<li>API_SECRET = ""</li>
	<li>API_Host = "http://api.census.gov"</li>
	<li>API_URI = "/data"</li>
	<li>API_DATA = "/2010/sf1"</li>
</ul></p>
<br>

<p> Adding implementation to the <strong>onCreate</strong> method will setup the request to the DOL Data service.<br>
 For DOL API dataset : <br /><br />
  The <strong>String method</strong> variable represents the Dataset and the table portion of the Data location path.<br><br>
-Format( Dateset/Table) i.e. "DOLAgency/Agencies", "FORMS/AgencyFormsTable", "FAQ/Topics", "FAQ/SubTopics".<br><br>
<sup>*</sup>Please Note: these paths are <strong>case sensitive</strong>, please refer to the corresponding Datasets for the correct formats. </p>

<pre class="prettyprint">@Override
public void onCreate(Bundle savedInstanceState)  {
	super.onCreate(savedInstanceState);
 
	// Instantiate context object
	GOVDataContext context = new GOVDataContext(API_KEY, SHARED_SECRET, API_HOST, API_URI, API_LOGIN, API_DATA);
        
 
	//Instantiate new request object. Pass the context var that contains all the API key info
	//Set this as the callback responder
	GOVDataRequest request = new GOVDataRequest(this, context);
 
	// API method to call
	String method = “DOLAgency/Agencies”;
 
	// Hashmap to store the arguments
	HashMap&lt;String, String&gt; args = new HashMap&lt;String, String&gt;(3);
 
	// Populate the args into the HashMap
	args.put(“top”, “20”);
	args.put(“select”, “Agency,AgencyFullName”);
	//args.put(“skip”, “30”);
 
	// Call the API method
	request.callAPIMethod(method, args);
}</pre><br><br></p>

<p> For DOL service operation : <br /><br />
  The <strong>String method</strong> variable represents the service method.<br><br>
<sup>*</sup>Please Note: Each String typed parameter of service request must be surrounded in quotes in order to work correctly. These quotes are then Url encoded and passed to the Service Operation. <br><br>

<pre class="prettyprint">
@Override
public void onCreate(Bundle savedInstanceState) {
	super.onCreate(SavedInstanceState);
	
	String methodname;

	// Instantiate context object
        GOVDataContext context = new GOVDataContext(API_KEY, SHARED_SECRET, API_HOST, API_URI, API_LOGIN, API_DATA);
	
	// Instantiate new requst object. Pass the context var that contains all the API key info
	// Set this as the callback responder
	GOVDataRequest request = new GOVDataRequest(this, context);
	
	// HashMap to store the arguments
	HashMap&lt;String, String&gt; summerJobsArgs = new HashMap&lt;String, String&gt;(7);
	
	// API method to call
	methodname = "SummerJobs/getJobsListing";
	// Populate the args into the HashMap
	summerJobsArgs.put("format", "'json'");
	summerJobsArgs.put("query", "'Farm'");
	summerJobsArgs.put("region", "''");
	summerJobsArgs.put("locality", "''");
	summerJobsArgs.put("skipCount", "'8'");
	
	request.callAPIMethod(methodname, summerJobsArgs);
}
</pre><br><br></p>


<p>
Adding implementation to the <strong>GOVDataErrorCallback</strong> method will provide feedback for errors that occur during the request.
<br><br>

<pre class="prettyprint">// Callback method called when error occurs
public void GOVDataErrorCallback(String error) {
	//Show error on dialog
	AlertDialog alertDialog;
	alertDialog = new AlertDialog.Builder(this).create();
	alertDialog.setTitle(“Error”);
	alertDialog.setMessage(error);
	alertDialog.show();
}</pre><br><br>

<p> For Government Entity API datasets calls : <br /><br />
Finally, adding an implementation to the <strong>GOVDataResultsCallback</strong> method will provide access to the results in the form of List of Map objects for DOL API calls.
</p>

<pre class="prettyprint">// Callback method called when results are returned and parsed
public void GOVDataResultsCallback(List&lt;Map&lt;String, String&gt;&gt; results) {
	// Create List of strings to populate the listview items
	List&lt;String&gt; display = new ArrayList&lt;String&gt;();
 
	// Iterate through list of results. Add each field to the display list
	for (Map&lt;String, String&gt; m : results) {
		display.add(m.get(“Agency”));
	}
 
	// Set list adapter.
	setListAdapter(new ArrayAdapter&lt;String&gt;(this,R.layout.list_item,display));
 
	// Enable text filtering
	ListView lv = getListView();
	lv.setTextFilterEnabled(true);

	
}</pre><br><br>


<p> For DOL service operation : <br /><br />
Finally, adding an implementation to the <strong>GOVDataResultsCallback</strong> method will provide access to the results in the form of List of Map objects.
	The developer has to clean the json response text to get the clean json object from 
	service response. Sometimes, search results may have special characters which can throw an error during JSON serialization.<br><br>

<pre class="prettyprint">// Callback method called when results are returned and parsed
public void GOVDataResultsCallback(List&lt;Map&String, String&gt;&gt; results) {
	// Create List of strings to populate the listview items
	List&lt;String&gt; display = new ArrayList&lt;String&gt;();
	// Create JSON Object and JSONArray to store the data from DOLService operation.
	JSONObject jsonObject = null;
	JSONArray subArray = null;
	// Iterate through list of results. Add each field to the display list
	for (Map&lt;String, String&gt; m : results) {
		try {
			// Look for value of getJobsListing property.
			if(null != m.get("getJobsListing"))
			{
				String jobs = m.get("getJobsListing");
				// convert jString to the jObject
				jobs = jobs.replaceAll("\\\\n", "");
				jobs = jobs.replaceAll("\\\\\"", "\"");
				jobs = jobs.replaceAll("\"\\{", "\\{");
				jobs = jobs.replaceAll("\\}\"", "\\}");
				// start extracting the content from jObject
				jsonObject = new JSONObject(jobs);
				if(null!=jsonObject)
				{
					// Look for an array of "item."
					subArray = jsonObject.getJSONArray("items");
					if(null!= subArray)
					{
						// Let's loop through each job
						for(int i=0; i&lt;subArray.length(); i++)
						{
							// Get the job title.
							display.add(subArray.getJSONObject(i).getString("title"));
						}
					}
				}
			}
		} catch (JSONException e) {
			e.printStackTrace();
		}
	}
	// Set the list adapter
	setListAdapter(new ArrayAdapter&lt;String&gt;(this,R.layout.list_item,display));
	// Enable text filtering
	ListView lv = getListView();
	lv.setTextFilterEnabled(true);
}
</pre>
</p></p></p>
<br>




<h2>Configure Android Security</h2>
<p>
Android gives its users the ability to grant application access to features they choose.  This requires our application to list the permissions this application needs in order for features to work correctly.
This is done by adding the uses-permission tag to the <strong>AndroidManifest.xml</strong> file.
<pre class="prettyprint">&lt;uses-permission android:name=”android.permission.INTERNET”&gt;&lt;/uses-permission&gt;</pre><br><br>
</p>
<br>


<h2>Run the Application</h2>
<p>
In order to run this application the emulator debug settings and the emulator need to be set up.  
Press <strong>F11</strong> or <strong>Run > Debug</strong> and a warning message will be displayed if an emulator has not been configured.
<br><br>
<img alt="Press F11 to Run the Application" src="images/NewEmulator.png" /><br><br>
Continue to the next screen and add a new emulator.<br><br>
<img alt="Add a new emulatore" src="images/NewEmulator2.png" /><br><br>
Give the emulator instance a name and configure the memory to your needs.<br><br>
<img alt="Give emulator instance a name and configure the memory " src="images/NewEmulator3.png" /><br><br>
Later you can setup Debug properties for you application as needed.<br><br>
<img alt="Setup Debug properties" src="images/DebugSetup.png" /><br><br>
<p> For DOL API dataset : <br /><br />
Run the application and you should see a list of Agencies in the grid.<br><br>
<img alt="Run the application and you should see a list of Agencies in the grid" src="images/Data.png" /></p>
<p> For DOL service operation : <br /><br />
Run the application and you should see a list of jobs in the grid.<br><br>
<img alt="Run the application and you should see a list of Jobs in the grid" src="images/summer_job_result_farm.png" /></p>
</p>


<!-- END CONTENT HERE  *************************************************** -->
<!---original location of this file: "/includes/" -->

</div><!--Body End -->

 </div>

	<!--Footer Start -->
	<div id="Footer">
		<div id="FooterMenu">
			<div id="FooterMenuContainer">
				<a href="http://www.dol.gov/dol/foia/main.htm">Freedom of Information Act</a>&nbsp;|&nbsp;

				<a href="http://www.dol.gov/dol/privacynotice.htm">Privacy & Security Statement</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/disclaim.htm">Disclaimers</a>&nbsp;|&nbsp;
				<a href="http://webapps.dol.gov/feedback/FeedbackSurvey.aspx">Customer Survey</a>&nbsp;|&nbsp;
				<a href="http://www.dol.gov/dol/aboutdol/website-policies.htm">Important Web Site Notices</a>&nbsp;|&nbsp;

                <a href="http://www.dol.gov/dol/aboutdol/plug-ins.htm">Plug-ins Used by DOL</a>
			</div>
		</div>
	
		<div id="FooterContact">
			<div id="FooterContactContainer">
				U.S. Department of Labor&nbsp;|&nbsp;Frances Perkins Building, 200 Constitution Ave., NW, Washington, DC 20210<br>

				<a href="http://www.dol.gov" style=" text-decoration: underline; ">www.dol.gov</a>&nbsp;|&nbsp;Telephone: 1-866-4-USA-DOL (1-866-487-2365)&nbsp;|&nbsp;TTY: 1-877-889-5627&nbsp;|&nbsp;<u><a href="http://www.dol.gov/dol/contact/index.htm">Contact Us</a></u>
			</div>
		</div>
	</div>
	<!--Footer End -->


</div><!--Main End -->

  </BODY>
</HTML>
